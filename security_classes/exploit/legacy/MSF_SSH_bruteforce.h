//
// Created by philipp on 02.03.19.
//

#ifndef GPNTF_MSF_SSH_BRUTEFORCE_H
#define GPNTF_MSF_SSH_BRUTEFORCE_H


#include <string>
#include "Metasploit_External.h"

class MSF_SSH_bruteforce : public Metasploit_External {
public:
    MSF_SSH_bruteforce(unsigned int id, unsigned int startDelaySec, unsigned int durationSec,
                       const std::string &targetHost, unsigned int targetPort, const std::string &exploitName,
                       const std::string &dictionaryFilePath) : Metasploit_External(id, startDelaySec, durationSec,
                                                                                    targetHost, targetPort,
                                                                                    exploitName),
                                                                dictionaryFilePath(dictionaryFilePath) {}

private:
    std::string dictionaryFilePath;
public:
    void get_msf_arguments() override {
        inputArguments = {
                MSF_FILE,
                MSF_QUIET_FLAG,
                MSF_COMMAND_FLAG,
                concatenateCommands()
        };
    }

    std::string concatenateCommands() {
        std::stringstream commandStream{};
        commandStream << getRhostsCommand(targetHost)
                      << getRPortCommand(targetPort)
                      << "set USERPASS_FILE " << dictionaryFilePath << MSF_MULTIPLE_CMDS_DELIM
                      << MSF_EXPLOIT_COMMAND << MSF_MULTIPLE_CMDS_DELIM;
        return commandStream.str();
    }


};


#endif //GPNTF_MSF_SSH_BRUTEFORCE_H
