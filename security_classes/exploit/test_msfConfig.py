from unittest import TestCase

from metasploit_external import MsfConfig


class TestMsfConfig(TestCase):

    def test_can_parse_config(self):
        config = MsfConfig("dummy_msf_config.ini")
        self.assertEqual('pass123', config.connection['password'])
        self.assertEqual("auxiliary", config.module['module_type'])
        self.assertEqual("scanner/ssh/ssh_login", config.module['module_name'])

    def test_case_sensitivity(self):
        config = MsfConfig("dummy_msf_config.ini")
        for key in config.mod_options:
            print("k: {}".format(key))
        self.assertNotEqual(config.mod_options['RHOSTS'], config.mod_options['rhosts'])
